<template>
        <v-expansion-panel-content>
            <v-card
                class="study-plan-boxes"
                elevation="0"
            >
                <v-expansion-panel-content>
                    <v-progress-linear
                        indeterminate
                        background-color="blue lighten-4"
                        color="blue accent-2"
                        :active="studyPlanLoading"
                    />
<!--                    <v-sheet-->
<!--                        class="study-plan-sheet"-->
<!--                    >-->
<!--                        فردا دیره، دیروز هم دیشب تموم شد، الان دقیقا لحظه ای هست که باید شروع-->
<!--                        کنی!-->
<!--                    </v-sheet>-->
                    <v-card
                        class="study-plan-card"
                        elevation="0"
                    >
                        <v-card-text>
                            <time-schedule-table
                                v-if="!studyPlanLoading"
                                :plans="studyPlan.plans"
                                :selected-major="selectedMajor"
                                :loading="studyPlanLoading"
                                :header-width="setHeaderWidthForMediaTags"
                                :opened-panel="openedPanel"
                                :not-the-same-plan="notTheSamePlan"
                                @planClicked="loadSelectedPlan"
                            />
                        </v-card-text>
                    </v-card>
                </v-expansion-panel-content>
                <individual-plan-details
                    :selected-plan="selectedPlan"
                    :opened-panel="openedPanel"
                    @contentClicked="contentClicked"
                />
            </v-card>
        </v-expansion-panel-content>
</template>

<script>
import timeScheduleTable from './TimeScheduleTable'
import { StudyPlan } from '@/models/StudyPlan'
import {Plan, PlanList} from '@/models/Plan'
import Major from '@/models/Major'
import IndividualPlanDetails from './IndividualPlanDetails'

export default {
    props: {
        studyPlan: {
            type: StudyPlan,
            default() {
                return new StudyPlan({
                    'studyPlan_id': 175,
                    'id': 144,
                    'date': '2021-03-22',
                    'voice': null,
                    'body': null,
                    'title': null,
                    'contents': null
                })
            }
        },
        selectedMajor: {
            default() {
                return new Major({
                    id: 1,
                    name: 'ریاضی'
                })
            },
            type: Major
        },
        studyPlanLoading : {
            default() {
                return false
            },
            type: Boolean
        },
        openedPanel : {
            default() {
                return false
            },
            type: Boolean
        }
    },
    components :{
        IndividualPlanDetails,
        timeScheduleTable,

    },
    created() {
    },
    computed :{
        windowSize() {
          return { x: window.innerWidth, y: window.innerHeight }
        },
        setHeaderWidthForMediaTags() {
            if (this.windowSize.x < 1920){
                return 140
            }
            else if (this.windowSize.x < 768){
                return 100
            }
            else if (this.windowSize.x > 1920){
                return 200

            }
        }
    },
    data() {
        return {
            planList : new PlanList(),
            selectedPlan: new Plan(),
            openedStudyPanel : [],
            notTheSamePlan : false
        }
    },
    methods: {
        contentClicked(content){
            this.$emit('contentClicked' , content )
        },
        loadSelectedPlan(plan){
            if (this.selectedPlan.id !== plan.id){
                this.selectedPlan = plan
                this.openedPanel = true
                this.notTheSamePlan = true
            }
            else {
                this.openedPanel =! this.openedPanel
            }
        }
    }
}
</script>

<style lang="scss" scoped>
.study-plan-boxes{
    background-color: #ffffff;
    color: #3e5480;
    margin-bottom: 1px;
    border-radius: 0 0 10px 10px;
    width: 99.6%;
    padding-top: 20px;
    @media only screen and (max-width: 768px){
        padding-top: 0px;
    }
    .study-plan-card{
        background-color: #e1f0ff;
        color: #3e5480;
        margin-top: 10px;
        margin-right: 0;
        padding: 0 5px 6px;
    }
}
.v-card{
    padding-top: 0 !important;
    .v-card__text{
        padding: 4px 0 !important;
        @media  screen and (max-width: 768px){
            padding: 0 !important;
        }

    }
}

.theme--light.v-sheet .study-plan-sheet {
    font-size: 14px;
    font-weight: normal;
    font-stretch: normal;
    font-style: normal;
    line-height: normal;
    letter-spacing: normal;
    text-align: center;
    background-color: #eff3ff;
    color: #3e5480;
    border-color: #FFFFFF;
    padding-top: 7px;
    padding-bottom: 5px;
    border-radius: 10px;
}
.v-expansion-panels:not(.v-expansion-panels--accordion):not(.v-expansion-panels--tile) > .v-expansion-panel--active {
    border-radius: 20px !important;
}
.v-expansion-panels:not(.v-expansion-panels--accordion):not(.v-expansion-panels--tile) > .v-expansion-panel--active {
    box-shadow: 0 3px 10px 0 rgb(0 0 0 / 10%);
}
.study-plan-card .theme--light.v-card > .v-card__text, .theme--light.v-card > .v-card__subtitle {
    color: rgba(0, 0, 0, 0.6);
    background-color: #e1f0ff;
}


</style>
<style lang="scss">
.v-text-field fieldset, .v-text-field .v-input__control, .v-text-field .v-input__slot {
    border-radius: 10px !important;
}
</style>
